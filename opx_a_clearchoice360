CREATE OR REPLACE VIEW tableau.opx_a_clearchoice360
(
  orderid,
  orderproductid,
  orderitempartid,
  parttoothstr,
  parttoothmask,
  partquantity,
  parttotalcharge,
  parttotaltax,
  toothlocation,
  toothtype,
  shade,
  productid,
  transactiontype,
  doctorid,
  patientname,
  dateindtslocal,
  dateinvoiceddtslocal,
  originfacilityid,
  productionfacilityid,
  pf_departmentid,
  pf_isactualunit,
  pf_productgroup,
  pf_productline,
  pf_producttype,
  sourcesystem,
  sourcesystemscanner,
  designsystem,
  millsystem,
  blocksize,
  blockcolor,
  gotreturned,
  returntype,
  returnorderid,
  returnorderproductid,
  returnorderitempartid,
  returnorderdateindtslocal,
  returnorderdateinvoiceddtslocal,
  returnparttoothstr,
  returnparttoothmask,
  returnproductid,
  returntoothlocation,
  returntoothtype,
  returnremakeid,
  returnorderremakereason,
  returnorderremakereasoncategory,
  returnitemremakereason,
  returnitemremakereasoncategory,
  returnquantity,
  daysbeforereturn,
  totalreturncount,
  delaycount,
  delaytimeinminutes,
  inboundcarriername,
  inboundtrackingnumber,
  inboundturnaroundtimeindays,
  orderentryturnaroundtimeinhours,
  outboundcarriername,
  outboundtrackingnumber,
  outboundturnaroundtimeindays,
  doctorgroupid,
  practicename,
  totalmillcount,
  totalmillunits,
  totalmillminutes,
  totaldesigncount,
  totaldesignunits,
  totaldesignminutes,
  totalscancount,
  totalscanminutes,
  totalscanunits,
  blockheight,
  blockmaterial,
  scannermake,
  scannermodel,
  milllocationname,
  designlocationid,
  designlocationname,
  scanlocationid,
  scanlocationname,
  millendlocaldts,
  designendlocaldts,
  scanendlocaldts,
  scanmachineserial
)
AS 
 SELECT order360infobypart.orderid, order360infobypart.orderproductid, order360infobypart.orderitempartid, order360infobypart.parttoothstr, order360infobypart.parttoothmask, order360infobypart.partquantity, order360infobypart.parttotalcharge, order360infobypart.parttotaltax, order360infobypart.toothlocation, order360infobypart.toothtype, order360infobypart.shade, order360infobypart.productid, order360infobypart.transactiontype, order360infobypart.doctorid, order360infobypart.patientname, order360infobypart.dateindtslocal, order360infobypart.dateinvoiceddtslocal, order360infobypart.originfacilityid, order360infobypart.productionfacilityid, order360infobypart.pf_departmentid, order360infobypart.pf_isactualunit, order360infobypart.pf_productgroup, order360infobypart.pf_productline, order360infobypart.pf_producttype, order360infobypart.sourcesystem, order360infobypart.sourcesystemscanner, order360infobypart.designsystem, order360infobypart.millsystem, order360infobypart.blocksize, order360infobypart.blockcolor, order360infobypart.gotreturned, order360infobypart.returntype, order360infobypart.returnorderid, order360infobypart.returnorderproductid, order360infobypart.returnorderitempartid, order360infobypart.returnorderdateindtslocal, order360infobypart.returnorderdateinvoiceddtslocal, order360infobypart.returnparttoothstr, order360infobypart.returnparttoothmask, order360infobypart.returnproductid, order360infobypart.returntoothlocation, order360infobypart.returntoothtype, order360infobypart.returnremakeid, order360infobypart.returnorderremakereason, order360infobypart.returnorderremakereasoncategory, order360infobypart.returnitemremakereason, order360infobypart.returnitemremakereasoncategory, order360infobypart.returnquantity, order360infobypart.daysbeforereturn, order360infobypart.totalreturncount, order360infobypart.delaycount, order360infobypart.delaytimeinminutes, order360infobypart.inboundcarriername, order360infobypart.inboundtrackingnumber, order360infobypart.inboundturnaroundtimeindays, order360infobypart.orderentryturnaroundtimeinhours, order360infobypart.outboundcarriername, order360infobypart.outboundtrackingnumber, order360infobypart.outboundturnaroundtimeindays, order360infobypart.doctorgroupid, order360infobypart.practicename, order360infobypart.totalmillcount, order360infobypart.totalmillunits, order360infobypart.totalmillminutes, order360infobypart.totaldesigncount, order360infobypart.totaldesignunits, order360infobypart.totaldesignminutes, order360infobypart.totalscancount, order360infobypart.totalscanminutes, order360infobypart.totalscanunits, order360infobypart.blockheight, order360infobypart.blockmaterial, order360infobypart.scannermake, order360infobypart.scannermodel, order360infobypart.milllocationname, order360infobypart.designlocationid, order360infobypart.designlocationname, order360infobypart.scanlocationid, order360infobypart.scanlocationname, order360infobypart.millendlocaldts, order360infobypart.designendlocaldts, order360infobypart.scanendlocaldts, order360infobypart.scanmachineserial
   FROM agg.order360infobypart
  WHERE order360infobypart.pf_isactualunit::text = 1::character varying::text AND (order360infobypart.doctorgroupid::text = 'clearchoic'::character varying::text OR order360infobypart.doctorgroupid::text = 'ClearChoic'::character varying::text OR order360infobypart.doctorgroupid::text = 'Clearchoic'::character varying::text);


GRANT SELECT ON tableau.opx_a_clearchoice360 TO _anthonyo;
GRANT SELECT ON tableau.opx_a_clearchoice360 TO executive;
GRANT SELECT ON tableau.opx_a_clearchoice360 TO _lucy;
GRANT SELECT ON tableau.opx_a_clearchoice360 TO operations;
GRANT INSERT, SELECT, UPDATE, RULE, DELETE, TRIGGER, REFERENCES ON tableau.opx_a_clearchoice360 TO cloudbeam;


COMMIT;
