CREATE OR REPLACE VIEW tableau.opa_6m_lastlocation
(
  orderid,
  originlocationfacilityid,
  originlocationbuilding,
  originlocationdepartment,
  originlocationzone,
  originlocationprocess,
  originlocationprocessdescription,
  currentlocationfacilityid,
  currentlocationbuilding,
  currentlocationdepartment,
  currentlocationzone,
  currentlocationprocess,
  currentlocationprocessdescription,
  currentlocationcheckindate,
  currentlocationcheckoutdate,
  assignmentcount,
  firstassignedto,
  firstassignmentstartdate,
  firstassignmentcompleteddate,
  lastassignedto,
  lastassignmentstartdate,
  lastassignmentcompleteddate,
  datein,
  duedate,
  dateinvoiced,
  rush,
  pannumber,
  panid,
  maxdaysinlab,
  labduedate,
  actualdaysinlab,
  daysremaining,
  productfacilityid,
  productdepartment,
  productsubdepartment,
  productline,
  productid,
  quantity
)
AS 
 SELECT caselocation_activecaseslastlocation.orderid, caselocation_activecaseslastlocation.originlocationfacilityid, caselocation_activecaseslastlocation.originlocationbuilding, caselocation_activecaseslastlocation.originlocationdepartment, caselocation_activecaseslastlocation.originlocationzone, caselocation_activecaseslastlocation.originlocationprocess, caselocation_activecaseslastlocation.originlocationprocessdescription, caselocation_activecaseslastlocation.currentlocationfacilityid, caselocation_activecaseslastlocation.currentlocationbuilding, caselocation_activecaseslastlocation.currentlocationdepartment, caselocation_activecaseslastlocation.currentlocationzone, caselocation_activecaseslastlocation.currentlocationprocess, caselocation_activecaseslastlocation.currentlocationprocessdescription, caselocation_activecaseslastlocation.currentlocationcheckindate, caselocation_activecaseslastlocation.currentlocationcheckoutdate, caselocation_activecaseslastlocation.assignmentcount, caselocation_activecaseslastlocation.firstassignedto, caselocation_activecaseslastlocation.firstassignmentstartdate, caselocation_activecaseslastlocation.firstassignmentcompleteddate, caselocation_activecaseslastlocation.lastassignedto, caselocation_activecaseslastlocation.lastassignmentstartdate, caselocation_activecaseslastlocation.lastassignmentcompleteddate, caselocation_activecaseslastlocation.datein, caselocation_activecaseslastlocation.duedate, caselocation_activecaseslastlocation.dateinvoiced, caselocation_activecaseslastlocation.rush, caselocation_activecaseslastlocation.pannumber, caselocation_activecaseslastlocation.panid, caselocation_activecaseslastlocation.maxdaysinlab, caselocation_activecaseslastlocation.labduedate, caselocation_activecaseslastlocation.actualdaysinlab, caselocation_activecaseslastlocation.daysremaining, caselocation_activecaseslastlocation.productfacilityid, caselocation_activecaseslastlocation.productdepartment, caselocation_activecaseslastlocation.productsubdepartment, caselocation_activecaseslastlocation.productline, caselocation_activecaseslastlocation.productid, caselocation_activecaseslastlocation.quantity
   FROM sum.caselocation_activecaseslastlocation
  WHERE caselocation_activecaseslastlocation.datein >= (( SELECT getdate() - '6 mons'::interval));

COMMIT;
