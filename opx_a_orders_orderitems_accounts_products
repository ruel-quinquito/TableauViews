CREATE OR REPLACE VIEW tableau.opx_a_orders_orderitems_accounts_products
(
  orderid,
  ordertypeid,
  ordertype,
  dateinlocaldts,
  dateinvoicedlocaldts,
  postdatelocaldts,
  duedatelocaldts,
  enteredby,
  invoicedby,
  linkto,
  remakeof,
  casestatusid,
  casestatus,
  doctorid,
  patientfirstname,
  patientlastname,
  inhousesale,
  shade,
  isrush,
  rushid,
  rushdescription,
  shipincarrierid,
  shipintrackingnumber,
  shipouttargetlocaldts,
  shipoutcarrierid,
  shipouttrackingnumber,
  shipaddressline1,
  shipaddressline2,
  shipaddresscity,
  shipaddressstate,
  shipaddresszipcode,
  shipaddresscountry,
  pannumber,
  externalorderid,
  origorderid,
  origorderdateinlocaldts,
  origorderdateinvoicedlocaldts,
  linkedorderid,
  linkedordertype,
  linkedorderdateinlocaldts,
  linkedorderdateinvoicedlocaldts,
  linkedorderremakeid,
  linkedorderremakereason,
  returnorderid,
  returnordertype,
  returnorderdateinlocaldts,
  returnorderdateinvoicedlocaldts,
  returnorderremakeid,
  returnorderremakereason,
  maxdaysinlab,
  labduelocaldts,
  actualdaysinlab,
  sourcesystem,
  sourcesystemscanner,
  panid,
  cod,
  orderproductid,
  productorder,
  originfacilityid,
  originfacility,
  productionfacilityid,
  productionfacility,
  transactiontype,
  toothstr,
  toothmask,
  isanterior,
  nomodel,
  quantity,
  unitprice,
  discount,
  remakediscount,
  totalcharge,
  totaltax,
  remakeid,
  reasonid,
  remakereason,
  isforsurcharge,
  isbridge,
  bodyshade,
  stumpshade,
  gingivalshade,
  incisalshade,
  orderitem_discountid,
  orderitem_enteredby,
  orderitme_entereddate,
  productid,
  products_source,
  discontinued,
  taxable,
  mdetaxable,
  description,
  departmentid,
  subdepartmentid,
  remakedepartment,
  remakecategory,
  majorgroupid,
  minorgroupid,
  marketingmajor,
  marketingminor,
  backloggroup,
  salescategory,
  unitcountgroup,
  unitgroupid,
  implantsystem,
  implantsystemvendor,
  pf_productgroup,
  pf_productline,
  pf_producttype,
  pf_departmentid,
  pf_isactualunit,
  bundlequantity,
  glcategory,
  satellitecategory,
  material,
  daysinlab_10,
  daysinlab_20,
  daysinlab_30,
  daysinlab_40,
  daysinlab_45,
  daysinlab_50,
  daysinlab_51,
  daysinlab_60,
  daysinlab_62,
  accounts_source,
  prospect,
  deleted,
  accountclosed,
  active,
  istestaccount,
  accounttypeid,
  accounttype,
  lab,
  accountid,
  licensenumber,
  glaccountid,
  prkaccountid,
  accountname,
  practicename,
  printoninvoice,
  firstname,
  middlename,
  lastname,
  address1,
  address2,
  address3,
  city,
  state,
  zipcode,
  zipcode2,
  country,
  billingaddress1,
  billingaddress2,
  billingaddress3,
  billingcity,
  billingstate,
  billingzipcode,
  billingzipcode2,
  billingcountry,
  shippingaddress1,
  shippingaddress2,
  shippingaddress3,
  shippingcity,
  shippingstate,
  shippingzipcode,
  shippingzipcode2,
  shippingcountry,
  codonly,
  officecontact,
  workphone,
  homephone,
  email,
  groupid,
  groupname,
  hasexemptioncertificate,
  territoryid,
  salespersonid,
  inhouseaccount,
  createdate,
  noentry,
  firstentrydate,
  lastentrydate
)
AS 
 SELECT o.orderid, o.ordertypeid, o.ordertype, o.dateinlocaldts, o.dateinvoicedlocaldts, o.postdatelocaldts, o.duedatelocaldts, o.enteredby, o.invoicedby, o.linkto, o.remakeof, o.casestatusid, o.casestatus, o.doctorid, o.patientfirstname, o.patientlastname, o.inhousesale, o.shade, o.isrush, o.rushid, o.rushdescription, o.shipincarrierid, o.shipintrackingnumber, o.shipouttargetlocaldts, o.shipoutcarrierid, o.shipouttrackingnumber, o.shipaddressline1, o.shipaddressline2, o.shipaddresscity, o.shipaddressstate, o.shipaddresszipcode, o.shipaddresscountry, o.pannumber, o.externalorderid, o1.origorderid, o1.origorderdateinlocaldts, o1.origorderdateinvoicedlocaldts, o1.linkedorderid, o1.linkedordertype, o1.linkedorderdateinlocaldts, o1.linkedorderdateinvoicedlocaldts, o1.linkedorderremakeid, o1.linkedorderremakereason, o1.returnorderid, o1.returnordertype, o1.returnorderdateinlocaldts, o1.returnorderdateinvoicedlocaldts, o1.returnorderremakeid, o1.returnorderremakereason, o1.maxdaysinlab, o1.labduelocaldts, o1.actualdaysinlab, o1.sourcesystem, o1.sourcesystemscanner, o1.panid, o1.cod, oi.orderproductid, oi1.productorder, oi.originfacilityid, oi.originfacility, oi.productionfacilityid, oi.productionfacility, oi.transactiontype, oi.toothstr, oi1.toothmask, oi1.isanterior, oi1.nomodel, oi.quantity, oi.unitprice, oi.discount, oi.remakediscount, oi.totalcharge, oi.totaltax, oi.remakeid, oi.reasonid, oi.remakereason, oi.isforsurcharge, oi.isbridge, oi.bodyshade, oi.stumpshade, oi.gingivalshade, oi.incisalshade, oi.discountid AS orderitem_discountid, oi.enteredby AS orderitem_enteredby, oi.entereddate AS orderitme_entereddate, oi.productid, p.source AS products_source, p.discontinued, p.taxable, p.mdetaxable, p.description, p.departmentid, p.subdepartmentid, p.remakedepartment, p.remakecategory, p.majorgroupid, p.minorgroupid, p.marketingmajor, p.marketingminor, p.backloggroup, p.salescategory, p.unitcountgroup, p.unitgroupid, p.implantsystem, p.implantsystemvendor, p.pf_productgroup, p.pf_productline, p.pf_producttype, p.pf_departmentid, p.pf_isactualunit, p.bundlequantity, p.glcategory, p.satellitecategory, p.material, p.daysinlab_10, p.daysinlab_20, p.daysinlab_30, p.daysinlab_40, p.daysinlab_45, p.daysinlab_50, p.daysinlab_51, p.daysinlab_60, p.daysinlab_62, a.source AS accounts_source, a.prospect, a.deleted, a.accountclosed, a.active, a.istestaccount, a.accounttypeid, a.accounttype, a.lab, a.accountid, a.licensenumber, a.glaccountid, a.prkaccountid, a.accountname, a.practicename, a.printoninvoice, a.firstname, a.middlename, a.lastname, a.address1, a.address2, a.address3, a.city, a.state, a.zipcode, a.zipcode2, a.country, a.billingaddress1, a.billingaddress2, a.billingaddress3, a.billingcity, a.billingstate, a.billingzipcode, a.billingzipcode2, a.billingcountry, a.shippingaddress1, a.shippingaddress2, a.shippingaddress3, a.shippingcity, a.shippingstate, a.shippingzipcode, a.shippingzipcode2, a.shippingcountry, a.codonly, a.officecontact, a.workphone, a.homephone, a.email, a.groupid, a.groupname, a.hasexemptioncertificate, a.territoryid, a.salespersonid, a.inhouseaccount, a.createdate, a.noentry, a.firstentrydate, a.lastentrydate
   FROM fct."order" o
   JOIN cal."order" o1 ON o1.orderid = o.orderid
   JOIN fct.orderitem oi ON oi.orderid = o.orderid
   JOIN cal.orderitem oi1 ON oi1.orderid = oi.orderid AND oi1.orderproductid = oi.orderproductid
   LEFT JOIN dim.accounts a ON a.accountid::text = o.doctorid::text
   LEFT JOIN dim.products p ON p.productid::text = oi.productid::text
  WHERE o.dateinlocaldts > '2009-01-01 00:00:00'::timestamp without time zone;

COMMIT;
