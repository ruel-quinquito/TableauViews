CREATE OR REPLACE VIEW tableau.opx_1w_caselocationwithhistory
(
  orderid,
  invoiced,
  caselocationsequenceid,
  lastlocation,
  locationfacilityid,
  locationbuilding,
  locationdepartment,
  locationzone,
  locationprocess,
  locationprocessdescription,
  locationcheckindate,
  locationcheckoutdate,
  assignmentcount,
  firstassignedto,
  firstassignmentstartdate,
  firstassignmentcompleteddate,
  lastassignedto,
  lastassignmentstartdate,
  lastassignmentcompleteddate,
  datein,
  duedate,
  dateinvoiced,
  rush,
  pannumber,
  panid,
  maxdaysinlab,
  labduedate,
  actualdaysinlab,
  daysremaining,
  productfacilityid,
  productdepartment,
  productsubdepartment,
  productline,
  productid,
  quantity
)
AS 
 SELECT caselocation_activecaseswithlocationhistory.orderid, 0 AS invoiced, caselocation_activecaseswithlocationhistory.caselocationsequenceid, caselocation_activecaseswithlocationhistory.lastlocation, caselocation_activecaseswithlocationhistory.locationfacilityid, caselocation_activecaseswithlocationhistory.locationbuilding, caselocation_activecaseswithlocationhistory.locationdepartment, caselocation_activecaseswithlocationhistory.locationzone, caselocation_activecaseswithlocationhistory.locationprocess, caselocation_activecaseswithlocationhistory.locationprocessdescription, caselocation_activecaseswithlocationhistory.locationcheckindate, caselocation_activecaseswithlocationhistory.locationcheckoutdate, caselocation_activecaseswithlocationhistory.assignmentcount, caselocation_activecaseswithlocationhistory.firstassignedto, caselocation_activecaseswithlocationhistory.firstassignmentstartdate, caselocation_activecaseswithlocationhistory.firstassignmentcompleteddate, caselocation_activecaseswithlocationhistory.lastassignedto, caselocation_activecaseswithlocationhistory.lastassignmentstartdate, caselocation_activecaseswithlocationhistory.lastassignmentcompleteddate, caselocation_activecaseswithlocationhistory.datein, caselocation_activecaseswithlocationhistory.duedate, caselocation_activecaseswithlocationhistory.dateinvoiced, caselocation_activecaseswithlocationhistory.rush, caselocation_activecaseswithlocationhistory.pannumber, caselocation_activecaseswithlocationhistory.panid, caselocation_activecaseswithlocationhistory.maxdaysinlab, caselocation_activecaseswithlocationhistory.labduedate, caselocation_activecaseswithlocationhistory.actualdaysinlab, caselocation_activecaseswithlocationhistory.daysremaining, caselocation_activecaseswithlocationhistory.productfacilityid, caselocation_activecaseswithlocationhistory.productdepartment, caselocation_activecaseswithlocationhistory.productsubdepartment, caselocation_activecaseswithlocationhistory.productline, caselocation_activecaseswithlocationhistory.productid, caselocation_activecaseswithlocationhistory.quantity
   FROM sum.caselocation_activecaseswithlocationhistory
UNION 
 SELECT caselocation_invoicedtodaywithlocationhistory.orderid, 1 AS invoiced, caselocation_invoicedtodaywithlocationhistory.caselocationsequenceid, caselocation_invoicedtodaywithlocationhistory.lastlocation, caselocation_invoicedtodaywithlocationhistory.locationfacilityid, caselocation_invoicedtodaywithlocationhistory.locationbuilding, caselocation_invoicedtodaywithlocationhistory.locationdepartment, caselocation_invoicedtodaywithlocationhistory.locationzone, caselocation_invoicedtodaywithlocationhistory.locationprocess, caselocation_invoicedtodaywithlocationhistory.locationprocessdescription, caselocation_invoicedtodaywithlocationhistory.locationcheckindate, caselocation_invoicedtodaywithlocationhistory.locationcheckoutdate, caselocation_invoicedtodaywithlocationhistory.assignmentcount, caselocation_invoicedtodaywithlocationhistory.firstassignedto, caselocation_invoicedtodaywithlocationhistory.firstassignmentstartdate, caselocation_invoicedtodaywithlocationhistory.firstassignmentcompleteddate, caselocation_invoicedtodaywithlocationhistory.lastassignedto, caselocation_invoicedtodaywithlocationhistory.lastassignmentstartdate, caselocation_invoicedtodaywithlocationhistory.lastassignmentcompleteddate, caselocation_invoicedtodaywithlocationhistory.datein, caselocation_invoicedtodaywithlocationhistory.duedate, caselocation_invoicedtodaywithlocationhistory.dateinvoiced, caselocation_invoicedtodaywithlocationhistory.rush, caselocation_invoicedtodaywithlocationhistory.pannumber, caselocation_invoicedtodaywithlocationhistory.panid, caselocation_invoicedtodaywithlocationhistory.maxdaysinlab, caselocation_invoicedtodaywithlocationhistory.labduedate, caselocation_invoicedtodaywithlocationhistory.actualdaysinlab, caselocation_invoicedtodaywithlocationhistory.daysremaining, caselocation_invoicedtodaywithlocationhistory.productfacilityid, caselocation_invoicedtodaywithlocationhistory.productdepartment, caselocation_invoicedtodaywithlocationhistory.productsubdepartment, caselocation_invoicedtodaywithlocationhistory.productline, caselocation_invoicedtodaywithlocationhistory.productid, caselocation_invoicedtodaywithlocationhistory.quantity
   FROM sum.caselocation_invoicedtodaywithlocationhistory;

COMMIT;
